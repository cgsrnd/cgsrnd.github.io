"use strict";(self.webpackChunkhsm=self.webpackChunkhsm||[]).push([[467],{57467:(ne,v,l)=>{l.r(v),l.d(v,{UserMgmtModule:()=>ee});var d=l(76733),m=l(45850),e=l(20755),a=l(43226),f=l(81076),U=l(30970),h=l(27857),g=l(35532),_=l(67116);function k(i,c){1&i&&(e.TgZ(0,"span",10),e._uU(1," Existing User"),e.qZA())}function w(i,c){1&i&&(e.TgZ(0,"span",10),e._uU(1," Existing Role"),e.qZA())}const O=function(){return["active"]};function T(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"a",11),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.routetab(s.label))}),e._uU(1),e.qZA()}if(2&i){const t=c.$implicit;e.Q6J("routerLinkActive",e.DdM(3,O))("routerLink",t.link),e.xp6(1),e.Oqu(t.label)}}function A(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",13),e._UZ(2,"span",14),e.TgZ(3,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addUser())}),e.TgZ(4,"mat-icon"),e._uU(5,"add"),e.qZA(),e._uU(6," New User"),e.qZA()()()}}function P(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",13),e._UZ(2,"span",14),e.TgZ(3,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addroles())}),e.TgZ(4,"mat-icon"),e._uU(5,"add"),e.qZA(),e._uU(6,"New Role"),e.qZA()()()}}let y=(()=>{class i{constructor(t,n,o,s,r){this.fb=t,this.rest=n,this.router=o,this.dialog=s,this.sharedService=r,this.selectedTabIndex=0,this.profiles=["HR","ADMIN","MANAGER"],this.usercolums=["profile","fullName","deleteicon"],this.activeLinkIndex=-1,this.tabheader="Users",this.activeTab="Users",this.navLinks=[{label:"Users",link:"./users",index:0},{label:"Roles",link:"./roles",index:1}]}ngOnInit(){this.getUsers(),this.router.events.subscribe(t=>{this.activeLinkIndex=this.navLinks.indexOf(this.navLinks.find(n=>n.link==="."+this.router.url))})}getUsers(){this.rest.getService("auth/web/v1/display/allUsers").subscribe(t=>{this.userList=t.data,this.userList.map(n=>{n.fullName=n.firstName+" "+n.lastName})})}savefn(t){console.log(t.target.id)}routetab(t){console.log(t),this.tabheader=t,this.activeTab=t}triggerResetUserInUsersComponent(){this.sharedService.triggerResetUser()}addUser(){this.triggerResetUserInUsersComponent()}addroles(){this.triggerResetUserInUsersComponent()}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(a.qu),e.Y36(f.v),e.Y36(m.F0),e.Y36(U.uw),e.Y36(h.F))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-user-mgmt"]],decls:13,vars:5,consts:[[1,"row","p-3","pb-0","pt-0"],[1,"row","px-3","mt-2"],[1,"col-md-4"],["class","existinguser ",4,"ngIf"],["class","existinguser",4,"ngIf"],["id","tabs",1,"full-width-tabs"],[1,"col-xs-12"],["id","nav-tab","role","tablist",1,"nav","nav-tabs","nav-fill"],["class","nav-item nav-link",3,"routerLinkActive","routerLink","click",4,"ngFor","ngForOf"],["class","col",4,"ngIf"],[1,"existinguser"],[1,"nav-item","nav-link",3,"routerLinkActive","routerLink","click"],[1,"col"],[1,"d-grid","gap-2","d-md-flex","justify-content-md-end"],[1,"spacer"],["mat-raised-button","","color","primary",1,"btn",3,"click"]],template:function(n,o){1&n&&(e._UZ(0,"div",0),e.TgZ(1,"div",1)(2,"div",2),e.YNc(3,k,2,0,"span",3),e.YNc(4,w,2,0,"span",4),e.TgZ(5,"section",5)(6,"div",6)(7,"nav")(8,"div",7),e.YNc(9,T,2,4,"a",8),e.qZA()()()()(),e.YNc(10,A,7,0,"div",9),e.YNc(11,P,7,0,"div",9),e.qZA(),e._UZ(12,"router-outlet")),2&n&&(e.xp6(3),e.Q6J("ngIf","Users"===o.tabheader),e.xp6(1),e.Q6J("ngIf","Roles"===o.tabheader),e.xp6(5),e.Q6J("ngForOf",o.navLinks),e.xp6(1),e.Q6J("ngIf","Users"===o.tabheader),e.xp6(1),e.Q6J("ngIf","Roles"===o.tabheader))},dependencies:[d.sg,d.O5,m.lC,m.rH,m.Od,g.lW,_.Hw],styles:['.contact-list-container[_ngcontent-%COMP%]{max-height:calc(100vh - 240px);overflow-y:auto;overflow-x:hidden;padding:10px}.user-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #ddd;padding:10px 0}.avatar-container[_ngcontent-%COMP%]{flex:0 0 60px;margin-right:10px;overflow:hidden;border-radius:50%}.user-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.user-details[_ngcontent-%COMP%]{flex-grow:1;margin-right:16px}.avatar[_ngcontent-%COMP%]{max-width:100%;height:auto}.user-details[_ngcontent-%COMP%]{flex:1;overflow:hidden}.user-name[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#0e0e0f}.user-name[_ngcontent-%COMP%], .user-email[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.user-email[_ngcontent-%COMP%]{font-size:12px;color:#171818}.delete-button[_ngcontent-%COMP%]{flex-shrink:0}@media (max-width: 768px){.avatar-container[_ngcontent-%COMP%]{flex:0 0 40px}.avatar[_ngcontent-%COMP%]{width:40px;height:40px}.user-name[_ngcontent-%COMP%]{font-size:14px}.user-email[_ngcontent-%COMP%]{font-size:12px}}body[_ngcontent-%COMP%]{background-color:#eee;margin-top:20px}.card[_ngcontent-%COMP%]{box-shadow:0 20px 27px #0000000d}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#6c6ff5}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{border:none}.text-muted[_ngcontent-%COMP%]{color:#8ca3bd!important}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{position:relative;color:#271050}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]:after{transform:scale(1)}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:after{content:"";background:#6c6ff5;height:2px;position:absolute;width:100%;left:0;bottom:-1px;transition:all .25s ease 0s;transform:scale(0)}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}.active-button[_ngcontent-%COMP%]{color:#0942fc}.user-title[_ngcontent-%COMP%]{float:left;width:50%;font-size:14px;color:#000;font-weight:700}.user-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-bottom:10px;font-size:13px;display:block;color:#545454;font-weight:500}.existinguser[_ngcontent-%COMP%]{font-size:13px;color:#3486cd;text-transform:uppercase;font-weight:600;position:relative;top:-4px}#tabs[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]   .nav-item.show[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#000;background-color:#fff!important;border-color:transparent transparent #f3f3f3;border-top:4px solid #0747a6!important;font-size:13px;font-weight:700}']})}return i})();var C=l(8239),M=l(22322),N=l(27130),I=l(39579),b=l(71502),p=l(43116),Z=l(28348),q=l(58447);function F(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",40)(1,"button",41),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,s=e.oxw();return e.KtG(s.askForDeletion(o.empCode))}),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()()}if(2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("disabled","No users found"===t.fullName)}}function J(i,c){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",33),e.ynx(2),e.TgZ(3,"div",34),e._UZ(4,"img",35),e.qZA(),e.TgZ(5,"div",36),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.userlist(s.userId,s.admin))}),e.TgZ(6,"div",37),e._uU(7),e.qZA(),e.TgZ(8,"div",38),e._uU(9),e.qZA()(),e.BQk(),e.YNc(10,F,4,1,"div",39),e.qZA(),e.BQk()}if(2&i){const t=c.$implicit,n=e.oxw();e.xp6(5),e.ekj("selected-user",t.userId===n.selectedUser),e.xp6(2),e.Oqu(t.fullName),e.xp6(2),e.Oqu(t.emailId),e.xp6(1),e.Q6J("ngIf",!t.admin)}}function S(i,c){if(1&i&&(e.TgZ(0,"mat-option",42),e._uU(1),e.qZA()),2&i){const t=c.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.profileName)}}function L(i,c){if(1&i&&(e.TgZ(0,"mat-option",42),e._uU(1),e.qZA()),2&i){const t=c.$implicit;e.Q6J("value",t.insId),e.xp6(1),e.Oqu(t.name)}}function R(i,c){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Mail id required"),e.qZA())}function D(i,c){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"follow the pattern of mailto:xxx@xyz.com"),e.qZA())}function Q(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",43)(1,"button",44),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.resetUser())}),e.TgZ(2,"mat-icon"),e._uU(3,"highlight_off"),e.qZA(),e._uU(4," Cancel "),e.qZA(),e._uU(5," \xa0 "),e.TgZ(6,"button",45),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onSubmit())}),e.TgZ(7,"mat-icon"),e._uU(8,"check_circle_outline"),e.qZA(),e._uU(9," submit "),e.qZA()()}}function Y(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",43)(1,"button",44),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.resetUser())}),e.TgZ(2,"mat-icon"),e._uU(3,"highlight_off"),e.qZA(),e._uU(4," Cancel "),e.qZA(),e._uU(5," \xa0 "),e.TgZ(6,"button",46),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.updateProfile())}),e.TgZ(7,"mat-icon"),e._uU(8,"check_circle_outline"),e.qZA(),e._uU(9," Update "),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("disabled",t.admindiable)}}let E=(()=>{class i{constructor(t,n,o,s,r,u){this.fb=t,this.rest=n,this.global=o,this.datePipe=s,this.sharedService=r,this.alert=u,this.usercolums=["profile","fullName","deleteicon"],this.updateuser=!1,this.searchInput="",this.admindiable=!1}ngOnInit(){this.getUsers(),this.getinst(),this.getprofile(),this.userForm=this.fb.group({userName:["",a.kI.required],firstName:["",a.kI.required],lastName:["",a.kI.required],emailId:["",[a.kI.required,a.kI.pattern("^[a-zA-Z0-9+_.-]+@[a-zA-Z0-9.-]+$")]],mobileNo:["",[a.kI.required,a.kI.minLength(10),a.kI.maxLength(10),a.kI.pattern("^[0-9]*$")]],dob:["",[this.futureDateValidator(),a.kI.required]],profileId:[,a.kI.required],status:[""],empCode:["",a.kI.required],gender:["",a.kI.required],address:["",a.kI.required],institudeName:["",a.kI.required],userId:[""]}),this.sharedService.resetUser$.subscribe(()=>{this.resetUser()})}futureDateValidator(){return t=>new Date(t.value)>new Date?{futureDate:!0}:null}convertToISODate(t){const[n,o,s]=t.split("-");return`${s}-${o}-${n}`}getUsers(){this.rest.getService("auth/web/v1/display/allUsers").subscribe(t=>{this.userList=t.data,this.userList.map(n=>{n.fullName=n.firstName+" "+n.lastName}),this.filteredUserList=this.userList})}getinst(){this.rest.getService("api/web/v1/get/institude/names").subscribe(t=>{this.institutes=t.data})}getprofile(){this.rest.getService("auth/web/v1/profiles").subscribe(t=>{this.profiles=t.data})}userlist(t,n){this.admindiable=!!n,this.selectedUser=t,this.rest.getService("auth/web/v1/display/allUsers").subscribe(o=>{this.filteredObject=o.data.filter(s=>s.userId===t)[0],this.userForm.patchValue(this.filteredObject),this.userForm.patchValue({dob:new Date(this.convertToISODate(this.filteredObject.dob))}),this.updateuser=!0})}onSubmit(){if(this.userForm.valid){const t=this.userForm.value;t.dob=this.datePipe.transform(t.dob,"yyyy-MM-dd"),this.onsubmitformdata(t)}else this.global.showAlert("Alert","please full the required input")}onsubmitformdata(t){var n=this;return(0,C.Z)(function*(){const o=new FormData;Object.keys(t).forEach(s=>{"status"!==s&&"userId"!==s&&o.append(s,t[s])}),n.rest.postDataemp("auth/web/v1/create/user",o).subscribe(s=>{"HMS_00"===s.respCode&&(n.global.showSuccessAlert(s.respStatus,s.data),n.getUsers(),n.resetUser()),"HMS_00"!==s.respCode&&n.global.showAlert(s.respStatus,s.message)},s=>{})})()}updateProfile(){if(this.userForm.valid){const t=this.userForm.value;t.dob=this.datePipe.transform(t.dob,"yyyy-MM-dd"),this.updateProfileWithImage(t)}else this.global.showAlert("Alert","please full the required input")}updateProfileWithImage(t){var n=this;return(0,C.Z)(function*(){const o=new FormData;Object.keys(t).forEach(s=>{"slide"!==s&&"cnfPassword"!==s&&"currentPassword"!==s&&"newPassword"!==s&&o.append(s,t[s])}),n.rest.putformdata("auth/web/v1/user/update",o).subscribe(s=>{"HMS_00"===s.respCode&&(t.slide?n.global.showSuccessAlert("Success","Profile has Successfully Update Password"):n.global.showSuccessAlert(s.respStatus,s.data)),"HMS_00"!==s.respCode&&n.global.showAlert(s.respStatus,s.message)},s=>{})})()}askForDeletion(t){this.global.showCnfAlert("Alert","Do you want to delete this record?").afterClosed().subscribe(o=>{"Y"===o&&this.deleteEmployee(t),"N"===o&&this.global.showToast("you cancelled the request")})}deleteEmployee(t){this.rest.putData("auth/web/v1/delete/user/"+t).subscribe(n=>{"HMS_00"===n.respCode&&(this.global.showSuccessAlert(n.respStatus,n.data),this.getUsers(),this.resetUser())},n=>{})}filterUsers(){if(""===this.searchInput.trim())this.filteredUserList=this.userList;else{const t=this.userList.filter(n=>n.fullName.toLowerCase().includes(this.searchInput.toLowerCase())||n.emailId&&n.emailId.toLowerCase().includes(this.searchInput.toLowerCase()));this.filteredUserList=0===t.length?[{fullName:"No users found",emailId:""}]:t}}close(t){}resetUser(){this.userForm.reset(void 0),this.updateuser=!1,this.selectedUser="",this.searchInput="",this.filteredUserList=this.userList}numberOnly(t){const n=t.which?t.which:t.keyCode;return!(n>31&&(n<48||n>57))}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(a.qu),e.Y36(f.v),e.Y36(M.U),e.Y36(d.uU),e.Y36(h.F),e.Y36(N.c))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-users"]],inputs:{name:"name"},decls:84,vars:11,consts:[[1,"w-100","cgs-containe","p-3","pt-2"],[1,"row","px-3"],[1,"col-md-4","py-2",2,"background-color","#ffffff"],[1,"full-width"],["matInput","","type","text",3,"ngModel","ngModelChange"],[1,"contact-list-container"],[1,"user-access"],[4,"ngFor","ngForOf"],[1,"col-md-8","py-2",2,"background-color","#ffffff"],[3,"formGroup"],["desigForm","ngForm"],[1,"row"],[1,"col-lg-6","col-md-6","col-sm-12"],["placeholder","Profile","formControlName","profileId","name","profileId"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Profile","formControlName","institudeName","name","institudeName"],["type","text","maxlength","30","onkeydown","return /[a-z]/i.test(event.key)","matInput","","autocomplete","off","placeholder","First Name","formControlName","firstName","name","firstName"],["type","text","maxlength","30","onkeydown","return /[a-z]/i.test(event.key)","matInput","","autocomplete","off","placeholder","Last Name","formControlName","lastName","name","lastName"],["formControlName","gender","name","gender"],["value","FEMALE"],["value","MALE"],["value","OTHER"],["matInput","","formControlName","dob",3,"matDatepicker","keypress"],["matSuffix","",3,"for"],["docPicker",""],["type","tel","matInput","","autocomplete","off","placeholder","Emp Code","formControlName","empCode","name","empCode","maxlength","6",3,"keypress"],["matInput","","placeholder","Mobile Number","formControlName","mobileNo","type","tel","maxlength","10",3,"keypress"],["matInput","","placeholder","Email","formControlName","emailId","type","email","maxlength","30"],[4,"ngIf"],["type","text","matInput","","autocomplete","off","placeholder","User Name","formControlName","userName","name","userName"],[1,"col",2,"padding-top","16px"],["matInput","","placeholder","Ex. Door no...","formControlName","address","name","address","maxlength","200"],["class","text-end",4,"ngIf"],[1,"user-item"],[1,"avatar-container"],["src","assets/imgs/user-empty.png","alt","User Avatar",1,"avatar"],[1,"user-details",3,"click"],[1,"user-name"],[1,"user-email"],["class","delete-button",4,"ngIf"],[1,"delete-button"],["mat-icon-button","","aria-label","Delete","color","accent",3,"disabled","click"],[3,"value"],[1,"text-end"],["type","button","mat-flat-button","","color","accent",3,"click"],["mat-flat-button","","color","primary","type","submit",3,"click"],["mat-flat-button","","color","primary","type","submit",3,"disabled","click"]],template:function(n,o){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-form-field",3)(4,"mat-label"),e._uU(5,"Search"),e.qZA(),e.TgZ(6,"input",4),e.NdJ("ngModelChange",function(r){return o.searchInput=r})("ngModelChange",function(){return o.filterUsers()}),e.qZA()(),e.TgZ(7,"div",5)(8,"div",6),e.YNc(9,J,11,5,"ng-container",7),e.qZA()()(),e.TgZ(10,"div",8)(11,"form",9,10)(13,"div",11)(14,"div",12)(15,"mat-form-field",3)(16,"mat-label"),e._uU(17,"Role"),e.qZA(),e.TgZ(18,"mat-select",13),e.YNc(19,S,2,2,"mat-option",14),e.qZA()()(),e.TgZ(20,"div",12)(21,"mat-form-field",3)(22,"mat-label"),e._uU(23,"Institute"),e.qZA(),e.TgZ(24,"mat-select",15),e.YNc(25,L,2,2,"mat-option",14),e.qZA()()(),e.TgZ(26,"div",12)(27,"mat-form-field",3)(28,"mat-label"),e._uU(29,"First Name"),e.qZA(),e._UZ(30,"input",16),e.qZA()(),e.TgZ(31,"div",12)(32,"mat-form-field",3)(33,"mat-label"),e._uU(34,"Last Name"),e.qZA(),e._UZ(35,"input",17),e.qZA()(),e.TgZ(36,"div",12)(37,"mat-form-field",3)(38,"mat-label"),e._uU(39,"Gender"),e.qZA(),e.TgZ(40,"mat-select",18)(41,"mat-option",19),e._uU(42,"Female"),e.qZA(),e.TgZ(43,"mat-option",20),e._uU(44,"Male"),e.qZA(),e.TgZ(45,"mat-option",21),e._uU(46,"Other"),e.qZA()()()(),e.TgZ(47,"div",12)(48,"mat-form-field",3)(49,"mat-label"),e._uU(50,"Date of Birth"),e.qZA(),e.TgZ(51,"input",22),e.NdJ("keypress",function(r){return o.numberOnly(r)}),e.qZA(),e._UZ(52,"mat-datepicker-toggle",23)(53,"mat-datepicker",null,24),e.qZA()(),e.TgZ(55,"div",12)(56,"mat-form-field",3)(57,"mat-label"),e._uU(58,"Employee Code"),e.qZA(),e.TgZ(59,"input",25),e.NdJ("keypress",function(r){return o.numberOnly(r)}),e.qZA()()(),e.TgZ(60,"div",12)(61,"mat-form-field",3)(62,"mat-label"),e._uU(63,"Mobile"),e.qZA(),e.TgZ(64,"input",26),e.NdJ("keypress",function(r){return o.numberOnly(r)}),e.qZA()()(),e.TgZ(65,"div",12)(66,"mat-form-field",3)(67,"mat-label"),e._uU(68,"Email ID"),e.qZA(),e._UZ(69,"input",27),e.YNc(70,R,2,0,"mat-error",28),e.YNc(71,D,2,0,"mat-error",28),e.qZA()(),e.TgZ(72,"div",12)(73,"mat-form-field",3)(74,"mat-label"),e._uU(75,"User name"),e.qZA(),e._UZ(76,"input",29),e.qZA()(),e.TgZ(77,"div",30)(78,"mat-form-field",3)(79,"mat-label"),e._uU(80,"Address"),e.qZA(),e._UZ(81,"textarea",31),e.qZA()()(),e.YNc(82,Q,10,0,"div",32),e.YNc(83,Y,10,1,"div",32),e.qZA()()()()),2&n){const s=e.MAs(54);let r,u;e.xp6(6),e.Q6J("ngModel",o.searchInput),e.xp6(3),e.Q6J("ngForOf",o.filteredUserList),e.xp6(2),e.Q6J("formGroup",o.userForm),e.xp6(8),e.Q6J("ngForOf",o.profiles),e.xp6(6),e.Q6J("ngForOf",o.institutes),e.xp6(26),e.Q6J("matDatepicker",s),e.xp6(1),e.Q6J("for",s),e.xp6(18),e.Q6J("ngIf",null==(r=o.userForm.get("emailId"))?null:r.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(u=o.userForm.get("emailId"))?null:u.hasError("pattern")),e.xp6(11),e.Q6J("ngIf",!o.updateuser),e.xp6(1),e.Q6J("ngIf",o.updateuser)}},dependencies:[d.sg,d.O5,I.ey,b.Mq,b.hl,b.nW,p.KE,p.hX,p.TO,p.R9,Z.Nt,q.gD,g.lW,g.RK,_.Hw,a._Y,a.Fj,a.JJ,a.JL,a.nD,a.On,a.sg,a.u],styles:[".contact-list-container[_ngcontent-%COMP%]{max-height:calc(100vh - 240px);overflow-y:auto;overflow-x:hidden}.user-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #ddd;padding:3px 0;margin-bottom:10px;cursor:pointer}.avatar-container[_ngcontent-%COMP%]{flex:0 0 40px;margin-right:10px;overflow:hidden;border-radius:50%}.user-details[_ngcontent-%COMP%]{flex-grow:1;margin-right:16px}.avatar[_ngcontent-%COMP%]{max-width:100%;height:auto}.user-details[_ngcontent-%COMP%]{flex:1;overflow:hidden}.user-name[_ngcontent-%COMP%], .user-email[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.delete-button[_ngcontent-%COMP%]{flex-shrink:0}@media (max-width: 768px){.avatar-container[_ngcontent-%COMP%]{flex:0 0 40px}.avatar[_ngcontent-%COMP%]{width:20px;height:20px}.user-name[_ngcontent-%COMP%]{font-size:14px}.user-email[_ngcontent-%COMP%]{font-size:12px}}.selected-user[_ngcontent-%COMP%]{cursor:pointer}.selected-user[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#303f9f}.selected-user[_ngcontent-%COMP%]   .user-email[_ngcontent-%COMP%]{font-size:12px;color:#303f9f}"]})}return i})();var H=l(14629),$=l(84948);function z(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",29)(1,"button",30),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,s=e.oxw();return e.KtG(s.askForDeletion(o))}),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()()}if(2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("disabled","No users found"===t.fullName)}}function G(i,c){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",23),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.editprofile(s))})("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.onItemClick(s.id))}),e.TgZ(2,"div",24),e._UZ(3,"img",25),e.qZA(),e.TgZ(4,"div",26)(5,"div",27),e._uU(6),e.qZA()(),e.YNc(7,z,4,1,"div",28),e.qZA(),e.BQk()}if(2&i){const t=c.$implicit,n=e.oxw();e.xp6(1),e.ekj("selected-item",t.id===n.selectedItemId),e.xp6(5),e.Oqu(t.profileName),e.xp6(1),e.Q6J("ngIf",!t.admin)}}function K(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"li")(1,"mat-checkbox",34),e.NdJ("ngModelChange",function(o){const r=e.CHM(t).$implicit;return e.KtG(r.selected=o)})("click",function(){e.CHM(t);const o=e.oxw().$implicit,s=e.oxw();return e.KtG(s.checkDashboardSubtask(o))}),e._uU(2),e.qZA()()}if(2&i){const t=c.$implicit;e.xp6(1),e.Q6J("ngModel",t.selected),e.xp6(1),e.hij(" ",t.name," ")}}function j(i,c){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",31)(2,"mat-checkbox",32),e.NdJ("ngModelChange",function(o){const r=e.CHM(t).$implicit;return e.KtG(r.selected=o)})("click",function(){const s=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.toggleDashboardSubtasks(s))}),e._uU(3),e.qZA(),e.TgZ(4,"ul",33),e.YNc(5,K,3,2,"li",7),e.qZA()(),e.BQk()}if(2&i){const t=c.$implicit,n=e.oxw();e.xp6(2),e.Q6J("ngModel",t.selected)("indeterminate",n.isIndeterminate(t)),e.xp6(1),e.hij(" ",t.menuGroupName," "),e.xp6(2),e.Q6J("ngForOf",t.menus)}}const B=[{path:"",component:y,children:[{path:"",redirectTo:"users",pathMatch:"full"},{path:"users",component:E},{path:"roles",component:(()=>{class i{constructor(t,n,o,s){this.fb=t,this.rest=n,this.global=o,this.sharedService=s,this.departmentList=[],this.submenuid=[],this.searchQuery="",this.selectedItemId=null,this.buttonDisable=!1}ngOnInit(){this.initForm(),this.getUsers(),this.getDepartment(),this.gerroles(),this.sharedService.resetUser$.subscribe(()=>{this.addRolses()})}initForm(){this.roleForm=this.fb.group({profileName:["",a.kI.required],description:["",a.kI.required]})}gerroles(){this.rest.getService("auth/web/v1/profile/group-menus/menus").subscribe(t=>{this.menuList=t.data,this.menuList.map(n=>{n.selected=!1,n.menus.map(o=>{o.selected=!1})}),console.log(this.menuList)})}addRolses(){this.roleForm.reset(),this.reset(),this.selectedItemId=0,this.userId="",this.searchQuery="",this.buttonDisable=!1}getUsers(){this.rest.getService("auth/web/v1/display/allUsers").subscribe(t=>{this.userList=t.data,this.userList.map(n=>{n.fullName=n.firstName+" "+n.lastName}),this.dataSource=new H.by(this.userList)})}inputCheck(t){console.log(t.target)}getDepartment(){this.rest.getService("auth/web/v1/profiles").subscribe(t=>{this.departmentList=t.data,console.log(this.departmentList)})}selectRole(t){console.log(t)}savefn(t){console.log(t.target.id)}showDetails(t,n){console.log(t,n)}isIndeterminate(t){const n=t.menus,o=n.filter(s=>s.selected).length;return o>0&&o<n.length}checkDashboardSubtask(t){const n=t.menus,o=n.some(r=>r.selected),s=n.every(r=>r.selected);t.selected=!!s||o}toggleDashboardSubtasks(t){const n=t.menus,o=t.selected;for(const s of n)s.selected=o}selectAll(){for(const t of this.menuList){t.selected=!0;for(const n of t.menus)n.selected=!0}this.allComplete=!0}reset(){for(const t of this.menuList){t.selected=!1;for(const n of t.menus)n.selected=!1}this.allComplete=!1}roleUpdate(){if(this.roleForm.valid){console.log(this.userId),this.iddata=this.menuList.map(s=>{s.menus.map(r=>{this.submenuid.push(r)})});const n=this.submenuid.filter(s=>!0===s.selected).map(s=>s.id),o=this.roleForm.getRawValue();o.roles=n,this.userId?this.rest.update("auth/web/v1/profile/"+this.userId,o).subscribe(s=>{"HMS_00"===s.respCode&&(console.log("it working"),this.global.showSuccessAlert(s.respStatus,s.data),this.getDepartment(),this.addRolses()),"HMS_00"!==s.respCode&&this.global.showAlert(s.respStatus,s.message)},s=>{}):this.rest.postDatanewuser("auth/web/v1/profile",o).subscribe(s=>{"HMS_00"===s.respCode&&(console.log("it working"),this.global.showSuccessAlert(s.respStatus,s.data),this.getDepartment(),this.addRolses()),"HMS_00"!==s.respCode&&this.global.showAlert(s.respStatus,s.message),this.getDepartment(),this.addRolses()})}}editprofile(t){this.userId=t.id,this.buttonDisable=!!t.admin,this.rest.getService(`auth/web/v1/profiles/${t.id}/selected/roles`).subscribe(n=>{var o=n.data.permissions;o.map(te=>{te.selected=!1});for(var s=0;s<o.length;s++){for(var r=o[s].menus.length,u=0,x=0;x<o[s].menus.length;x++)o[s].menus[x].selected&&(u+=1);r==u?o[s].selected=!0:u>0&&(o[s].selected=!1)}this.menuList=o,this.roleForm.patchValue({profileName:n.data.profileName,description:n.data.description})})}askForDeletion(t){this.global.showCnfAlert("Alert","Do you want to delete this record?").afterClosed().subscribe(o=>{console.log("Alert Data: "+o),"Y"===o&&this.deleteList(t),"N"===o&&this.global.showToast("you cancelled the request")})}deleteList(t){console.log(t.id),this.rest.deleteData(`auth/web/v1/profile/${t.id}?force=true`).subscribe(n=>{this.getDepartment(),this.addRolses(),this.global.showSuccessAlert(n.respStatus,n.data)},n=>{})}filterList(){return this.departmentList.filter(t=>t.profileName.toLowerCase().includes(this.searchQuery.toLowerCase()))}onItemClick(t){this.selectedItemId=t}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(a.qu),e.Y36(f.v),e.Y36(M.U),e.Y36(h.F))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-roles"]],decls:40,vars:6,consts:[[1,"w-100","cgs-container","p-3","pt-2"],[1,"row","px-3"],[1,"col-md-4","py-2",2,"background-color","#ffffff"],[1,"full-width"],["matInput","","type","text",3,"ngModel","ngModelChange"],[1,"contact-list-container"],[1,"user-access"],[4,"ngFor","ngForOf"],[1,"col-md-8","py-2",2,"background-color","#ffffff"],[1,"row","align-items-start",3,"formGroup"],[1,"col-md-6","col-lg","col-sm"],["appearance","outline",1,"full-width"],["matInput","","placeholder","Name","onkeydown","return /[a-z]/i.test(event.key)","required","","formControlName","profileName"],[1,"col-md","col-lg","col-sm"],["matInput","","placeholder","Description","onkeydown","return /[a-z]/i.test(event.key)","required","","formControlName","description"],[1,"text-end","me-3"],["mat-stroked-button","","color","accent",1,"btn","btn-primary","me-md-3",3,"click"],[1,"spacer"],["mat-stroked-button","","color","primary",1,"btn","btn-primary",3,"click"],[1,"menu-container"],[1,"text-end","me-3",2,"background-color","#ffffff"],["type","button","mat-flat-button","","color","accent",3,"click"],["mat-flat-button","","color","primary","type","submit",3,"disabled","click"],[1,"user-item",3,"click"],[1,"avatar-container"],["src","assets/imgs/user-empty.png","alt","User Avatar",1,"avatar"],[1,"user-details"],[1,"user-name"],["class","delete-button",4,"ngIf"],[1,"delete-button"],["mat-icon-button","","aria-label","Delete","color","accent",3,"disabled","click"],[1,"menu-item"],["color","primary",3,"ngModel","indeterminate","ngModelChange","click"],[1,"subtask-list"],["color","primary",3,"ngModel","ngModelChange","click"]],template:function(n,o){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-form-field",3)(4,"mat-label"),e._uU(5,"Search"),e.qZA(),e.TgZ(6,"input",4),e.NdJ("ngModelChange",function(r){return o.searchQuery=r}),e.qZA()(),e.TgZ(7,"div",5)(8,"div",6),e.YNc(9,G,8,4,"ng-container",7),e.qZA()()(),e.TgZ(10,"div",8)(11,"div",9)(12,"div",10)(13,"mat-form-field",11)(14,"mat-label"),e._uU(15,"Name"),e.qZA(),e._UZ(16,"input",12),e.qZA()(),e.TgZ(17,"div",13)(18,"mat-form-field",11)(19,"mat-label"),e._uU(20,"Description"),e.qZA(),e._UZ(21,"input",14),e.qZA()()(),e.TgZ(22,"div",15)(23,"button",16),e.NdJ("click",function(){return o.reset()}),e._uU(24,"Reset"),e.qZA(),e._UZ(25,"span",17),e.TgZ(26,"button",18),e.NdJ("click",function(){return o.selectAll()}),e._uU(27,"Select all"),e.qZA()(),e.TgZ(28,"div",19),e.YNc(29,j,6,4,"ng-container",7),e.qZA()(),e.TgZ(30,"div",20)(31,"button",21),e.NdJ("click",function(){return o.addRolses()}),e.TgZ(32,"mat-icon"),e._uU(33,"highlight_off"),e.qZA(),e._uU(34," Cancel "),e.qZA(),e._uU(35," \xa0 "),e.TgZ(36,"button",22),e.NdJ("click",function(){return o.roleUpdate()}),e.TgZ(37,"mat-icon"),e._uU(38,"check_circle_outline"),e.qZA(),e._uU(39),e.qZA()()()()),2&n&&(e.xp6(6),e.Q6J("ngModel",o.searchQuery),e.xp6(3),e.Q6J("ngForOf",o.filterList()),e.xp6(2),e.Q6J("formGroup",o.roleForm),e.xp6(18),e.Q6J("ngForOf",o.menuList),e.xp6(7),e.Q6J("disabled",o.buttonDisable),e.xp6(3),e.hij("",o.userId?"Update":"Submit"," "))},dependencies:[d.sg,d.O5,$.oG,p.KE,p.hX,Z.Nt,g.lW,g.RK,_.Hw,a.Fj,a.JJ,a.JL,a.Q7,a.On,a.sg,a.u],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.user-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #ddd;padding:3px 0;margin-bottom:10px;cursor:pointer}.avatar-container[_ngcontent-%COMP%]{flex:0 0 40px;margin-right:10px;overflow:hidden;border-radius:50%}.user-details[_ngcontent-%COMP%]{flex-grow:1;margin-right:16px}.avatar[_ngcontent-%COMP%]{max-width:100%;height:auto}.user-details[_ngcontent-%COMP%]{flex:1;overflow:hidden}.user-name[_ngcontent-%COMP%], .user-email[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.delete-button[_ngcontent-%COMP%]{flex-shrink:0}@media (max-width: 768px){.avatar-container[_ngcontent-%COMP%]{flex:0 0 40px}.avatar[_ngcontent-%COMP%]{width:20px;height:20px}.user-name[_ngcontent-%COMP%]{font-size:14px}.user-email[_ngcontent-%COMP%]{font-size:12px}}.selected-item[_ngcontent-%COMP%]{cursor:pointer}.selected-item[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#303f9f}.selected-item[_ngcontent-%COMP%]   .user-email[_ngcontent-%COMP%]{font-size:12px;color:#303f9f}.menu-container[_ngcontent-%COMP%]{max-height:calc(100vh - 240px);overflow-y:auto;overflow-x:hidden;display:flex;flex-wrap:wrap;gap:20px;justify-content:space-between}.menu-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.subtask-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0 0 0 20px}.subtask-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:5px 0}.cgs-container[_ngcontent-%COMP%]{padding:1rem}.text-center[_ngcontent-%COMP%]{text-align:center}.row[_ngcontent-%COMP%]{margin-left:-15px;margin-right:-15px}.col-md-4[_ngcontent-%COMP%], .col-md-8[_ngcontent-%COMP%], .col-md-6[_ngcontent-%COMP%], .col-lg[_ngcontent-%COMP%], .col-sm[_ngcontent-%COMP%]{padding:0 15px;box-sizing:border-box}.full-width[_ngcontent-%COMP%]{width:100%}.contact-list-container[_ngcontent-%COMP%], .menu-container[_ngcontent-%COMP%]{max-height:calc(100vh - 150px);overflow-y:auto;overflow-x:hidden;padding:10px}.menu-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px;justify-content:space-between}.menu-item[_ngcontent-%COMP%]{flex-basis:calc(50% - 10px);background-color:#fff;border:1px solid #ddd;border-radius:5px;box-shadow:0 2px 4px #0000001a;padding:10px}@media (max-width: 992px){.col-md-4[_ngcontent-%COMP%], .col-md-8[_ngcontent-%COMP%]{flex-basis:100%;max-width:100%}.menu-item[_ngcontent-%COMP%]{flex-basis:calc(100% - 10px)}}"]})}return i})()}]}];let V=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.oAB({type:i});static#n=this.\u0275inj=e.cJS({imports:[m.Bz.forChild(B),m.Bz]})}return i})();var W=l(35614),X=l(96961);let ee=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.oAB({type:i});static#n=this.\u0275inj=e.cJS({imports:[d.ez,V,W.h,a.u5,a.UX,X.Nh]})}return i})()}}]);